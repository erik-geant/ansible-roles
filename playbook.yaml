---

# basic vagrant box doesn't have python installed
- hosts: vagrant
  become: true
  gather_facts: false

  tasks:
  - name: install python 2
    raw: test -e /usr/bin/python || (apt -y update && apt install -y python-minimal)

# install openvswitch & related
- hosts: all
  become: true
  gather_facts: true

  tasks:
  - name: update apt cache
    apt:
      update_cache: true

  - name: install openvswitch
    action: apt pkg={{item}} state=latest
    with_items:
      - openvswitch-common
      - openvswitch-switch

  - name: install virtualbox and vagrant
    action: apt pkg={{item}} state=latest
    with_items:
      - virtualbox
      - vagrant

  - name: install wireshark
    apt:
      name: wireshark
      state: installed

  - name: setuid dumpcap
    file:
      path: /usr/bin/dumpcap
      owner: root
      group: root
      mode: 04755 


# install python
- hosts: all
  become: true
  gather_facts: true

  tasks:
  - name: update apt cache
    apt:
      update_cache: true

  - name: install pip
    apt:
      name: python-pip
      state: latest

  - name: upgrade pip
    pip:
      name: pip
      state: latest

  - name: install virtualenv
    pip:
      name: virtualenv

  - name: install virtualenvwrapper
    pip:
      name: virtualenvwrapper



